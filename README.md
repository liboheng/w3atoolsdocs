# 虚拟麦克风配置教程


本教程介绍如何在 Windows 和 Mac 上配置虚拟麦克风，用于 Perle 语音录制自动任务。


---


## Windows - VB-Cable 配置


### 1. 下载安装


1. 访问官网：https://vb-audio.com/Cable/
2. 下载 `VBCABLE_Driver_Pack43.zip`
3. 解压后，**右键以管理员身份运行** `VBCABLE_Setup_x64.exe`
4. 安装完成后 **重启电脑**


### 2. 配置系统音频


#### 设置默认播放设备


1. 右键任务栏音量图标 → `声音设置`
2. 或打开 `控制面板` → `硬件和声音` → `声音`
3. 在 `播放` 选项卡，找到 `CABLE Input`
4. 右键 → `设为默认设备`
5. 点击 `应用`


#### 设置默认录音设备


1. 切换到 `录音` 选项卡
2. 找到 `CABLE Output`
3. 右键 → `设为默认设备`
4. 点击 `应用` → `确定`


### 3. 验证配置


确认以下设置：


| 类型 | 设备名称 | 状态 |
|------|---------|------|
| 播放设备 | CABLE Input (VB-Audio Virtual Cable) | ✓ 默认 |
| 录音设备 | CABLE Output (VB-Audio Virtual Cable) | ✓ 默认 |


### 4. 浏览器权限


首次运行任务时，浏览器会询问麦克风权限：
- 选择 `CABLE Output`
- 点击 `允许`


### 5. 恢复正常使用


任务完成后，记得将播放设备改回真实扬声器/耳机，否则你将听不到任何声音。


---


## Mac - BlackHole 2ch 配置


### 1. 下载安装


1. 访问官网：https://existential.audio/blackhole/
2. 选择 `BlackHole 2ch`（免费版，2 声道足够）
3. 填写邮箱获取下载链接，或直接下载
4. 下载 `.pkg` 文件，双击安装
5. 按提示完成安装（可能需要输入系统密码）


### 2. 创建多输出设备（推荐）


创建多输出设备可以让你在录音的同时也能听到声音。


#### 步骤：


1. **打开音频 MIDI 设置**
   - 按 `Command + 空格`
   - 搜索 `Audio MIDI Setup` 或 `音频 MIDI 设置`
   - 回车打开


2. **创建多输出设备**
   - 点击左下角 `+` 按钮
   - 选择 `创建多输出设备`


3. **配置多输出设备**
   - 在右侧勾选：
     - ✅ BlackHole 2ch
     - ✅ 你的真实扬声器（如 MacBook Pro Speakers、外接耳机等）
   - 确保 BlackHole 2ch 在列表中


4. **设为默认输出**
   - 右键新建的 `多输出设备`
   - 选择 `用于声音输出`


### 3. 配置系统音频


#### 方法 A：使用多输出设备（推荐）


可以同时录音和监听：


1. 打开 `系统偏好设置` → `声音`
2. **输出** 选择：`多输出设备`
3. **输入** 选择：`BlackHole 2ch`


#### 方法 B：仅用 BlackHole（静音模式）


仅录音，听不到声音：


1. 打开 `系统偏好设置` → `声音`
2. **输出** 选择：`BlackHole 2ch`
3. **输入** 选择：`BlackHole 2ch`


> ⚠️ 注意：此模式下你将听不到任何系统声音

### 4. 验证配置


确认以下设置（系统偏好设置 → 声音）：


| 类型 | 设备名称 |
|------|---------|
| 输出 | 多输出设备（或 BlackHole 2ch） |
| 输入 | BlackHole 2ch ✓ |


### 5. 浏览器权限


首次运行任务时，浏览器会询问麦克风权限：
- 选择 `BlackHole 2ch`
- 点击 `允许`


如果下拉列表没有出现 BlackHole：
1. 打开浏览器设置
2. 搜索 `麦克风` 或 `Microphone`
3. 手动选择 `BlackHole 2ch`


### 6. 恢复正常使用


任务完成后，将输出设备改回真实扬声器，否则你将听不到任何声音。


---


## 常见问题


### Q: 浏览器麦克风列表没有虚拟设备？


**解决方案：**
- 重启浏览器
- 检查系统权限设置（Windows: 隐私设置 → 麦克风；Mac: 安全性与隐私 → 隐私 → 麦克风）
- 确认虚拟设备驱动已正确安装


### Q: 录音没有声音？


**解决方案：**
- 确认系统播放设备是虚拟设备（VB Cable Input / BlackHole）
- 检查音量是否静音
- 确认脚本正在播放音频


### Q: 录音有杂音或其他声音混入？


**解决方案：**
- 关闭其他可能发出声音的应用程序
- 关闭系统通知声音
- 确保没有其他音频正在播放


### Q: 想在录音时同时听到声音？


**解决方案：**
- **Mac**：使用多输出设备（见上方配置）
- **Windows**：可以安装 VoiceMeeter（更高级的虚拟音频软件）


### Q: 任务完成后听不到声音了？


**解决方案：**
- 将系统播放设备改回真实扬声器/耳机
- Windows: 声音设置 → 播放 → 选择真实设备
- Mac: 系统偏好设置 → 声音 → 输出 → 选择真实设备


---


## 快速检查清单


运行任务前，请确认：


- [ ] 虚拟麦克风软件已安装
- [ ] 系统播放设备已设为虚拟设备
- [ ] 系统录音/输入设备已设为虚拟设备
- [ ] 浏览器已授权麦克风权限
- [ ] 其他音频应用已关闭


---


## 相关链接


- VB-Cable 官网：https://vb-audio.com/Cable/
- BlackHole 官网：https://existential.audio/blackhole/
- VoiceMeeter（Windows 高级方案）：https://vb-audio.com/Voicemeeter/
